@model Pandora.Cigfi.Models.Cigfi.Banner
@{
    ViewBag.title = "编辑Banner";
}
<link href="/css/cropper.min.css" rel="stylesheet" />

<div class="wrapper wrapper-content animated fadeInRight">
    <div class="ibox float-e-margins">
        <div class="ibox-content">
            <form asp-action="Edit" method="post" class="form-horizontal m-t" id="editBannerForm" enctype="multipart/form-data">
                <input type="hidden" asp-for="Id" />
                <div class="form-group">
                    <label class="col-sm-3 control-label">图片：</label>
                    <div class="col-sm-8">
                        <input type="hidden" asp-for="ImageUrl" id="ImageUrl" />
                        <div id="aCoverImgUrl" style="margin-bottom:10px;@(string.IsNullOrEmpty(Model.ImageUrl) ? "display:none;" : "")">
                            <img id="midImg" style="max-width:200px;max-height:200px;" src="@(string.IsNullOrEmpty(Model.ImageUrl) ? "/images/default.JPG" : Model.ImageUrl)" />
                        </div>
                        <input type="file" id="CoverImg" name="imageFile" accept="image/*" class="form-control" style="display:inline-block;width:auto;" />
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-3 control-label">跳转链接：</label>
                    <div class="col-sm-8">
                        <input asp-for="LinkUrl" class="form-control" placeholder="填写跳转链接">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-3 control-label">排序：</label>
                    <div class="col-sm-8">
                        <input asp-for="SortOrder" class="form-control" placeholder="填写排序">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-3 control-label">是否启用：</label>
                    <div class="col-sm-8">
                        <select asp-for="IsActive" class="form-control">
                            <option value="true">是</option>
                            <option value="false">否</option>
                        </select>
                    </div>
                </div>
                <div class="hr-line-dashed"></div>
                <div class="form-group">
                    <div class="col-sm-4 col-sm-offset-3">
                        <button class="btn btn-primary" type="submit"><i class="fa fa-save"></i> 提交 </button>
                        <a asp-action="Index" class="btn btn-default"><i class="fa fa-close"></i> 取消 </a>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

<script src="/js/cropper/cropper.min.js"></script>
<script>
    $(function () {
        // 图片预览
        $("#CoverImg").change(function () {
            var file = this.files[0];
            if (file) {
                var reader = new FileReader();
                reader.onload = function (e) {
                    $("#midImg").attr('src', e.target.result);
                    $("#aCoverImgUrl").show();
                }
                reader.readAsDataURL(file);
            }
        });
        
        // 不再自动DoPost，直接用表单submit
    });
</script>